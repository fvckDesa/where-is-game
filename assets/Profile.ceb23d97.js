import{b as U,r as a,c as w,d as l,H as L,j as r,x as h,m as R,I as q,B as C,E as x,J as k}from"./index.24d213bf.js";import{u as E,e as F}from"./form.285ef807.js";function I(){var m,p;const{user:t}=U(),{register:s,handleSubmit:b,formState:{errors:c,isSubmitting:v},setValue:u}=E(),n=a.exports.useRef(),[i,f]=a.exports.useState({file:null,url:null}),y=w(),{ref:P,...N}=s("profilePicture",{onChange:e=>d(e.target.files[0]),value:i.file});a.exports.useEffect(()=>()=>URL.revokeObjectURL(i.url),[i.file]),a.exports.useEffect(()=>{u("name",t.name),u("email",t.email),i.file==null&&f(e=>({...e,url:t.profilePicture}))},[t]);async function j(e){const o={...e,profilePicture:i.file};try{await x(t.id,o)}catch(g){if(g.code!=="auth/requires-recent-login"){console.error(g);return}if(!await k()){y("/auth/confirmAuth",{state:{next:"/settings/profile",data:o}});return}await x(t.id,o)}}function d(e){!e||f({file:e,url:URL.createObjectURL(e)})}const S=a.exports.useCallback(()=>n.current.click(),[n]);return l(L,{title:"public profile",onSubmit:b(j),children:[l("main",{className:"flex",children:[l("div",{className:"flex-[0.6] flex flex-col gap-4",children:[r(h,{label:"Name",type:"text",error:(m=c.name)==null?void 0:m.message,...s("name",{required:"This field is required"})}),r(h,{label:"Email",type:"text",error:(p=c.email)==null?void 0:p.message,...s("email",{required:"This field is required",validate:F})})]}),r("div",{className:"flex-[0.4] flex flex-col justify-between items-center",children:l(R,{className:"flex justify-center items-center w-40 h-40 rounded-full border border-gray-500 overflow-hidden transition-all",onDrop:d,dragOverClass:"ring ring-offset-2 ring-gray-500",children:[r("img",{className:"w-full h-full object-cover cursor-pointer transition-all hover:grayscale",src:i.url||q,alt:"profile picture",referrerPolicy:"no-referrer",onClick:S}),r("input",{className:"hidden",type:"file",accept:"image/*",ref:e=>{P(e),n.current=e},...N})]})})]}),r("footer",{className:"flex mt-8",children:r(C,{isLoading:v,className:"flex-[0.2] px-4 py-2 rounded-lg bg-tiber-500 text-alabaster-500 transition-colors hover:bg-tiber-600",children:"Update Profile"})})]})}export{I as default};
