import{r,a as R,u as j,b as O,c as U,s as T,d as p,j as l,e as $,P as z,h as A,F as H,D as L,S as W,i as X}from"./index.20a8e46f.js";import{u as Y}from"./useGameImage.ad0bd41c.js";import{w as q}from"./withAuth.4099624d.js";function B(s){const[e,c]=r.exports.useState(),[a,n]=r.exports.useState(!1);r.exports.useEffect(()=>{R(s).then(t=>c({...t,characters:t.characters.map(o=>({...o,found:!1}))}))},[s]),r.exports.useEffect(()=>{e!=null&&e.characters.every(t=>t.found)&&n(!0)},[e]);function d(t){c(o=>({...o,characters:o.characters.map(i=>({...i,found:i.id===t?!0:i.found}))}))}return{game:e,setFound:d,isGameOver:a}}function J(s=!1){const[e,c]=r.exports.useState(0);return r.exports.useEffect(()=>{let a;return s?clearInterval(a):a=setInterval(()=>c(n=>n+1),1e3),()=>clearInterval(a)},[s]),e}function K(){const{x:s,y:e,setCoords:c,containerRef:a,imageRef:n}=Y({x:0,y:0}),[d,t]=r.exports.useState(!1),[o,i]=r.exports.useState(),{id:m}=j(),{game:f,isGameOver:h,setFound:C}=B(m),v=J(h),{user:G}=O(),I=U();r.exports.useEffect(()=>{h&&(T(m,G.name,v),I(`/leaderboard/${m}`))},[h]);function S(){i(null)}function w(u){c(u),t(!0)}function b(u){u.stopPropagation(),t(!1)}function N(u,{x:P,y}){const D=n.current.scrollWidth,F=n.current.scrollHeight,k=P*D,E=y*F,x=X(50),g=x(s,k)&&x(e,E);i(g),g&&C(u)}return f?p("div",{className:"h-[90%] overflow-hidden relative",children:[l($,{characters:f.characters,timer:v}),p("div",{className:"h-[90%] w-full relative",children:[l(z,{className:o?"bg-green-500":"bg-red-500",message:o?"nice":"character is not here",active:o,onClose:S}),l("div",{ref:a,className:"h-full w-full px-[60px] pb-[60px] overflow-y-scroll relative z-0",children:l(A,{ref:n,image:f.image,containerRef:a,x:s,y:e,onClick:w,children:d&&p(H,{children:[l(L,{characters:f.characters,x:s,y:e,onClose:b,onSelect:N}),l(W,{x:s,y:e})]})})})]})]}):"Loading..."}const Z=q(K);export{Z as default};
